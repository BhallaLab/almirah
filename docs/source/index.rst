Almirah
=======

.. toctree::
   :hidden:
   :maxdepth: 3      

   user-guide
   tutorial
   writing-configs/index
   reference/index
   contributing
   code-of-conduct   
   changelog

almirah aids in the organization, maintenance, and usage of both
file-based and table-based datasets. Developed to handle neuroimaging
datasets, it provides data format conversion support for specific
modalities.

Out-of-the-box, almirah supports:

- BIDS specification for neuroimaging datasets.
- BIDS-like specification for genome sequence data.
- Interfacing with databases supported by SQLAlchemy.
- File format conversion for neuorimaging data.
- Lazy access of DataLad compatible datasets.

With some time on config writing, almirah can:

- Organize unformatted datasets.
- Query and filter across the dataset.
- Migrate records from one database to another.

.. _Installing:
  
Installing
----------

almirah can be installed with `pip <https://pip.pypa.io>`_:

.. code-block:: bash
		
		$ python -m pip install almirah

Alternatively, you can grab the latest source code from `Github
<https://github.com/girishmm/almirah>`_:

.. code-block:: bash

		$ git clone https://github.com/girishmm/almirah.git
		$ cd almirah
		$ pip install .

Usage
-----

The :doc:`user-guide` is the place to go to learn how to use the
libray and accomplish common dataset related tasks. If you have the
time, we recommend following the :doc:`tutorial` for a complete
overview.

almirah relies heavily on configs to guide its tasks. The
:doc:`writing-configs/index` page describes the possibilities in
detail.

The :doc:`reference/index` documentation provides API-level
documentation.

Can you use almirah to manage other datasets? Of course! Have a look
at the :ref:`translate_to_another_dataset` section for files to tweak
to achieve this.

If you want to access the CALM-Brain resource, please head over to the
`user guide <https://girishmm.github.io/calm-brain/user-guide.html>`_
for a walk-through. The `reference <https://girishmm.github.io/calm-brain/reference.html>`_
documentation provides details on the files and records available in
the dataset. If you have not heard of the resource, but would like to
know, please visit the `CALM-Brain`_ online page help acquaint you.

.. _CALM-Brain: https://www.calm-brain.ncbs.res.in/

Who uses almirah?
-----------------

almirah was primarily developed to support and maintain the data
generated by the CBM-ADBS study. But we believe it can aid with other
datasets too! Even non-neuroimaging ones!

If almirah was able to help with your dataset, we would love to hear
about it.

.. _translate_to_another_dataset:

Translate to another dataset
----------------------------

If your dataset is a BIDS dataset, congrats you are done! ðŸŽ‰

The BIDS specification config is available in the repo and you can use
it.

If your dataset follows a different specification, describe it as a
config file by referring to :doc:`writing-configs/specification`. This
should allow filtering and querying of the dataset.

If you would like to organize data according to a described
specification, define rules according to :doc:`writing-configs/rules`.

If you need assistance migrating records from one database to another,
or one schema to another, :doc:`writing-configs/mapping` can guide
you.

If you need help writing a config file or would like to suggest an
improvement, please do reach out via the repo.

Dependencies
------------

`almirah`_ provides out-of-the-box routines for format conversion in
neuroimaging datasets. These are implemented as wrappers around other
standard libraries in different languages. These libraries might have
dependencies that are not resolved during `almirah`_ installation. The
pipelines and their respective externally installed dependencies are:

  * MRI format conversion         : `dcm2niix`_
  * MRI defacing                  : `FMRIB Software Library`_
  * MRI preprocessing             : `FreeSurfer`_, `Statistical Parametric Mapping`_
  * EEG format conversion         : `mne-bids`_
  * NIRS format conversion        : `mne-nirs`_
  * Eyetracking format conversion : `edf2asc`_

.. _edf2asc: https://www.sr-research.com/support/thread-7674.html   
.. _dcm2niix: https://github.com/rordenlab/dcm2niix
.. _mne-bids: https://mne.tools/mne-bids/stable/index.html
.. _mne-nirs: https://mne.tools/mne-nirs/stable/index.html
.. _FreeSurfer: https://surfer.nmr.mgh.harvard.edu/
.. _FMRIB Software Library: https://fsl.fmrib.ox.ac.uk/fsl/fslwiki
.. _Statistical Parametric Mapping: https://www.fil.ion.ucl.ac.uk/spm/

.. important::
   
   Though not mentioned explicitly, it is implied that it is necessary
   to have the language the library is implemented in installed. For
   example, `SPM`_ requires `MATLAB`_.

.. _SPM: https://www.fil.ion.ucl.ac.uk/spm/
.. _MATLAB: https://in.mathworks.com/products/matlab.html

License
-------

almirah is made available under the MIT License. For more details, see
`LICENSE <https://github.com/girishmm/almirah/blob/dev/LICENSE>`_.

Contributing
------------

We happily welcome contributions, please see :doc:`contributing` for
details.

Help and Support
----------------

We try to make almirah robust, but there might be things we missed. If it
does not meet your use case or you have trouble adapting it to your
dataset, please `write to us <girishmm@ncbs.res.in>`_ or open an issue
on the `repository <https://github.com/girishmm/almirah>`_ or drop by
`Github Discussions <https://github.com/girishmm/almirah/discussions>`_.

Citing
------

If you use almirah to help with your dataset, please consider citing this
repository until a journal article is specifically available for almirah.

Acknowledgements
----------------

almirah builds on other libraries and some parts are implemented as a
wrapper around modules in these libraries. Thanks to the developers,
maintainers, and contributors of these for the amazing documentation
and great work!

- mne
- mne-bids
- mne-nirs
- dcm2bids
- pybids  
- SQLAlchemy

.. rubric:: References

- Alexandre Gramfort, Martin Luessi, Eric Larson, Denis A. Engemann,
  Daniel Strohmeier, Christian Brodbeck, Roman Goj, Mainak Jas, Teon
  Brooks, Lauri Parkkonen, and Matti S. HÃ¤mÃ¤lÃ¤inen. MEG and EEG data
  analysis with MNE-Python. Frontiers in Neuroscience,
  7(267):1â€“13, 2013. doi: https://doi.org/10.3389/fnins.2013.00267.
  
- Appelhoff, S., Sanderson, M., Brooks, T., Vliet, M., Quentin, R.,
  Holdgraf, C., Chaumon, M., Mikulan, E., Tavabi, K., HÃ¶chenberger,
  R., Welke, D., Brunner, C., Rockhill, A., Larson, E., Gramfort, A.,
  & Jas, M. (2019). MNE-BIDS: Organizing electrophysiological data
  into the BIDS format and facilitating their analysis. Journal of
  Open Source Software, 4:1896. doi:
  https://doi.org/10.21105/joss.01896.
  
- Robert Luke, Eric D. Larson, Maureen J. Shader, Hamish Innes-Brown,
  Lindsey Van Yper, Adrian K. C. Lee, Paul F. Sowman, David
  McAlpine. Analysis methods for measuring passive auditory fNIRS
  responses generated by a block-design paradigm. Neurophotonics,
  Vol. 8, Issue 2, 025008 (May 2021). doi:
  https://doi.org/10.1117/1.NPh.8.2.025008.
  
- BorÃ©, A., Guay, S., Bedetti, C., Meisler, S., &
  GuenTher, N. (2023). Dcm2Bids (Version 3.0.2) [Computer
  software]. doi: https://doi.org/10.5281/zenodo.8306314.
  
- Yarkoni et al., (2019). PyBIDS: Python tools for BIDS
  datasets. Journal of Open Source Software, 4(40), 1294.  doi:
  https://doi.org/10.21105/joss.01294.

- Michael Bayer. SQLAlchemy. In Amy Brown and Greg Wilson, editors,
  The Architecture of Open Source Applications Volume II: Structure,
  Scale, and a Few More Fearless Hacks 2012 http://aosabook.org.
