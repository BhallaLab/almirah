<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="API Reference" href="../reference/index.html" /><link rel="prev" title="Organization rules" href="rules.html" />

    <link rel="shortcut icon" href="../_static/favicon.png"/><!-- Generated with Sphinx 7.3.7 and Furo 2023.09.10 -->
        <title>Database mapping - almirah 0.4.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=649a27d8" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f0f0f0;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">almirah 0.4.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/logo-full-light.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/logo-full-dark.png" alt="Dark Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../user-guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorial</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Writing configs</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Writing configs</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="specification.html">Specification details</a></li>
<li class="toctree-l2"><a class="reference internal" href="rules.html">Organization rules</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Database mapping</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../reference/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/dataset.html">Dataset and its Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/database.html">Database and DBManager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/layout.html">Layout, File, and Tag</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/specification.html">Specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/indexer.html">Indexing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/convert.html">File format conversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/unique.html">Unique Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/utils.html">Utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../code-of-conduct.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="edit-this-page">
  <a class="muted-link" href="https://github.com/girishmm/almirah/edit/main/docs/source/writing-configs/mapping.rst" title="Edit this page">
    <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" />
      <line x1="13.5" y1="6.5" x2="17.5" y2="10.5" />
    </svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="database-mapping">
<h1>Database mapping<a class="headerlink" href="#database-mapping" title="Link to this heading">¶</a></h1>
<p>It is convenient to store tabular records in a SQL database. There
might be usecases where it is necessary to migrate to another
schema. For this, the mapping between the columns in the previous
schema to the new schema is required along with any transformations to
be performed. almirah supports database migration with help from a
user-written mapping config whose options are detailed in this
document. Each table is defined as a seperated document and are
separated by <code class="docutils literal notranslate"><span class="pre">---</span></code>.</p>
<p>A minimal configuration to migrate a table with columns <code class="docutils literal notranslate"><span class="pre">id</span></code> and
<code class="docutils literal notranslate"><span class="pre">name</span></code> looks like this:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">table</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">source_table_name</span>
<span class="nt">maps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">target_table_name</span>
<span class="nt">cols</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">id</span>
<span class="w">    </span><span class="nt">dtype</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">integer</span>
<span class="w">    </span><span class="nt">maps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">id</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">name</span>
<span class="w">    </span><span class="nt">dtype</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">str</span>
<span class="w">    </span><span class="nt">maps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">name</span>
</pre></div>
</div>
<p>The above mapping can be used for database migration with <code class="xref py py-meth docutils literal notranslate"><span class="pre">migrate()</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># First, import migrate from the db module</span>
<span class="kn">from</span> <span class="nn">almirah.db</span> <span class="kn">import</span> <span class="n">migrate</span>

<span class="c1"># Migrate from source to target according to mapping</span>
<span class="n">migrate</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">mapping</span><span class="p">)</span>
</pre></div>
</div>
<section id="top-level-keys">
<h2>Top-level keys<a class="headerlink" href="#top-level-keys" title="Link to this heading">¶</a></h2>
<section id="table">
<h3><code class="docutils literal notranslate"><span class="pre">table</span></code><a class="headerlink" href="#table" title="Link to this heading">¶</a></h3>
<p>The table in target database to which records will be inserted.</p>
<p>If the table does not exist, it is created.</p>
</section>
<section id="maps">
<h3><code class="docutils literal notranslate"><span class="pre">maps</span></code><a class="headerlink" href="#maps" title="Link to this heading">¶</a></h3>
<p>The table in source database from which records will be selected.</p>
</section>
<section id="cols">
<h3><code class="docutils literal notranslate"><span class="pre">cols</span></code><a class="headerlink" href="#cols" title="Link to this heading">¶</a></h3>
<p>All details regarding fixed column mappings sit inside the <code class="docutils literal notranslate"><span class="pre">cols</span></code>
key. It consists of a sequence of entries that provide information on
the column, its datatype, validations to pass, and transformations if
any.</p>
<p>The column mapping is defined using:</p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">name</span></code></dt><dd><p>The column in target table that corresponds to the source column.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dtype</span></code></dt><dd><p>The datatype of the column values.</p>
<p>Can be <code class="docutils literal notranslate"><span class="pre">str</span></code>, <code class="docutils literal notranslate"><span class="pre">bool</span></code>, <code class="docutils literal notranslate"><span class="pre">date</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">integer</span></code>, or
<code class="docutils literal notranslate"><span class="pre">datetime</span></code>. Optionally <code class="docutils literal notranslate"><span class="pre">str</span></code> accepts a length parameter as
<code class="docutils literal notranslate"><span class="pre">str(length)</span></code> that defines the maximum number of characters
allowed.</p>
<p>If the values received from source column is of a different type,
then type casting is attempted which on failing default to <code class="docutils literal notranslate"><span class="pre">Not</span>
<span class="pre">Available</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">maps</span></code></dt><dd><p>The column in the source table that this columns corresponds to.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">primary</span></code></dt><dd><p>Boolean value indicating whether the column is a primary key.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">refs</span></code></dt><dd><p>If the column refers to a column in a different table, its complete name.</p>
<p>This is used to provide foreign key constraints. The complete name
should be of the form <code class="docutils literal notranslate"><span class="pre">{table</span> <span class="pre">name}.{column</span> <span class="pre">name}</span></code>.</p>
</dd>
</dl>
<p>Validations can be provided using:</p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">like</span></code></dt><dd><p>Regex pattern defining how the value should look like from start to end.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">between</span></code></dt><dd><p>Bounds within which the value should lie.</p>
<p>The bounds can be provided as comma-separated values enclosed in
square brackets. For example, <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">10]</span></code> to indicate that the
value should lie between <code class="docutils literal notranslate"><span class="pre">0</span></code> and <code class="docutils literal notranslate"><span class="pre">10</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">in</span></code></dt><dd><p>Sequence of valid values.</p>
<p>The valid values can be comma-separated in square brackets. For
example, <code class="docutils literal notranslate"><span class="pre">[Yes,</span> <span class="pre">No]</span></code> to indicated that the value should be
either <code class="docutils literal notranslate"><span class="pre">Yes</span></code> or <code class="docutils literal notranslate"><span class="pre">No</span></code>.</p>
</dd>
</dl>
<p>Values can be transformed and massaged to a different format using:</p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">extract</span></code></dt><dd><p>Regex pattern with a capturing group.</p>
<p>The value captured is used in place of the complete value.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">case</span></code></dt><dd><p>Perform case tranformations to the value.</p>
<p>Accepts <code class="docutils literal notranslate"><span class="pre">lower</span></code> or <code class="docutils literal notranslate"><span class="pre">upper</span></code> to convert all characters to
lowercase and uppercase respectively.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">replace</span></code></dt><dd><p>Replace one value with another either based on a mapping.</p>
<p>If the mapping is present in an external file, it can be provided
as collection of mappings with <code class="docutils literal notranslate"><span class="pre">value</span></code>, <code class="docutils literal notranslate"><span class="pre">to</span></code>, and <code class="docutils literal notranslate"><span class="pre">file</span></code>
keys. The <code class="docutils literal notranslate"><span class="pre">value</span></code> and <code class="docutils literal notranslate"><span class="pre">to</span></code> keys indicate the column which
might contain the value to be replaced and the column which will
contain the value that will replace respectively. The path to the
external file is provided by <code class="docutils literal notranslate"><span class="pre">file</span></code>. <code class="docutils literal notranslate"><span class="pre">strict</span></code> can set to
<code class="docutils literal notranslate"><span class="pre">False</span></code> to retain previous values if mapping is not found.</p>
<p>The mapping can also be provided directly as a sequence of
<code class="docutils literal notranslate"><span class="pre">value</span></code>:<code class="docutils literal notranslate"><span class="pre">to</span></code> key pairs where <code class="docutils literal notranslate"><span class="pre">to</span></code> replaces <code class="docutils literal notranslate"><span class="pre">value</span></code>.</p>
</dd>
</dl>
<p>Validation and transformation generates log messages in which column
values may show up in case of errors. To stop these values from
displaying in columns containing sensitive information, the <code class="docutils literal notranslate"><span class="pre">hide</span></code>
flag inside <code class="docutils literal notranslate"><span class="pre">cols</span></code> can be set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</section>
<section id="attach">
<h3><code class="docutils literal notranslate"><span class="pre">attach</span></code><a class="headerlink" href="#attach" title="Link to this heading">¶</a></h3>
<p>Columns that will be attached due to reshaping sit inside the
<code class="docutils literal notranslate"><span class="pre">attach</span></code> key. It supports all sub-keys supported by <code class="docutils literal notranslate"><span class="pre">cols</span></code>.</p>
<p>It is redundant to provide map value for columns in <code class="docutils literal notranslate"><span class="pre">attach</span></code> as
their value are inferred from the records based on the reshape
procedure. If your column needs to map to a column in source table,
maybe <code class="docutils literal notranslate"><span class="pre">cols</span></code> or <code class="docutils literal notranslate"><span class="pre">detach</span></code> is more relevant.</p>
</section>
<section id="detach">
<h3><code class="docutils literal notranslate"><span class="pre">detach</span></code><a class="headerlink" href="#detach" title="Link to this heading">¶</a></h3>
<p>Columns that will be removed in the processing of reshaping sit inside
the <code class="docutils literal notranslate"><span class="pre">detach</span></code> key. It supports all sub-keys supported by <code class="docutils literal notranslate"><span class="pre">cols</span></code>.</p>
<p>Columns under <code class="docutils literal notranslate"><span class="pre">detach</span></code> are typically serve as columns that are
considered for melting into one.</p>
</section>
<section id="refs">
<h3><code class="docutils literal notranslate"><span class="pre">refs</span></code><a class="headerlink" href="#refs" title="Link to this heading">¶</a></h3>
<p>If a set of columns make a composite foreign key constraint, they can
be provided as a sequence of columns and their respective foreign key
link.</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">cols</span></code></dt><dd><p>Columns in the table that are part of the composite reference.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">links</span></code></dt><dd><p>The complete name of the column referred to in the same order as <code class="docutils literal notranslate"><span class="pre">cols</span></code>.</p>
</dd>
</dl>
<p>Both <code class="docutils literal notranslate"><span class="pre">cols</span></code> and <code class="docutils literal notranslate"><span class="pre">links</span></code> can be provided as comma-separated values
enclosed in square brackets.</p>
</section>
<section id="reshape">
<h3><code class="docutils literal notranslate"><span class="pre">reshape</span></code><a class="headerlink" href="#reshape" title="Link to this heading">¶</a></h3>
<p>Provide step-wise instructions to massage the records from one
structure to another.</p>
<p>Reshaping instructions can be provided as a sequence of supported
procedures as keys with a sequence of their respective arguments under
them. The procedures are implemented using pandas methods and will
thus use the same argument names as the specific pandas method.</p>
<p>Reshaping procedures:</p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">add</span></code></dt><dd><p>Add new column <code class="docutils literal notranslate"><span class="pre">name</span></code> with given <code class="docutils literal notranslate"><span class="pre">value</span></code>. Takes a <code class="docutils literal notranslate"><span class="pre">name</span></code> and
<code class="docutils literal notranslate"><span class="pre">value</span></code> key sequence with their values.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">split</span></code></dt><dd><p>Split column <code class="docutils literal notranslate"><span class="pre">name</span></code> into multiple columns based on delimiter
<code class="docutils literal notranslate"><span class="pre">pat</span></code> and rename the generated columns to <code class="docutils literal notranslate"><span class="pre">rename</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">melt</span></code></dt><dd><p>Massage a set of columns into a single column.</p>
<p>Uses arguments similar to <code class="xref py py-meth docutils literal notranslate"><span class="pre">melt()</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">pivot</span></code></dt><dd><p>Pivot to wide-form by grouping rows with similar identifiers.</p>
<p>Uses arguments similar to <code class="xref py py-meth docutils literal notranslate"><span class="pre">pivot_table()</span></code>.</p>
</dd>
</dl>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../reference/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">API Reference</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="rules.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Organization rules</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, girish
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/girishmm/almirah/" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Database mapping</a><ul>
<li><a class="reference internal" href="#top-level-keys">Top-level keys</a><ul>
<li><a class="reference internal" href="#table"><code class="docutils literal notranslate"><span class="pre">table</span></code></a></li>
<li><a class="reference internal" href="#maps"><code class="docutils literal notranslate"><span class="pre">maps</span></code></a></li>
<li><a class="reference internal" href="#cols"><code class="docutils literal notranslate"><span class="pre">cols</span></code></a></li>
<li><a class="reference internal" href="#attach"><code class="docutils literal notranslate"><span class="pre">attach</span></code></a></li>
<li><a class="reference internal" href="#detach"><code class="docutils literal notranslate"><span class="pre">detach</span></code></a></li>
<li><a class="reference internal" href="#refs"><code class="docutils literal notranslate"><span class="pre">refs</span></code></a></li>
<li><a class="reference internal" href="#reshape"><code class="docutils literal notranslate"><span class="pre">reshape</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=1437fa6d"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    </body>
</html>